package cc.unknown.module.impl.exploit;

import cc.unknown.event.impl.EventLink;
import cc.unknown.event.impl.packet.PacketEvent;
import cc.unknown.module.Module;
import cc.unknown.module.impl.ModuleCategory;
import cc.unknown.module.setting.impl.SliderValue;
import cc.unknown.utils.client.AdvancedTimer;
import cc.unknown.utils.player.PlayerUtil;
import net.minecraft.network.play.server.S32PacketConfirmTransaction;
import net.minecraft.util.EnumChatFormatting;

public class ACDetector extends Module {
	
	private SliderValue delay = new SliderValue("Delay", 100, 0, 300, 1);
	private AdvancedTimer timer = new AdvancedTimer(0);

	public ACDetector() {
		super("ACDetector", ModuleCategory.Exploit);
		this.registerSetting(delay);
	}

	@EventLink
	public void onPacket(PacketEvent e) {
	    if (e.isReceive()) {
	        if (e.getPacket() instanceof S32PacketConfirmTransaction) {
	        	if (timer.hasTimeElapsed(delay.getInputToLong(), true)) {
	        		PlayerUtil.send(EnumChatFormatting.RED + " [Transaction ID]: " + EnumChatFormatting.RESET + ((S32PacketConfirmTransaction) e.getPacket()).getActionNumber());
	        	}
	        }
	    }
	}
}
