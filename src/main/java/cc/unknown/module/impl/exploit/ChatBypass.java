package cc.unknown.module.impl.exploit;

import java.util.Arrays;
import java.util.stream.Collectors;

import cc.unknown.event.impl.api.EventLink;
import cc.unknown.event.impl.packet.PacketEvent;
import cc.unknown.event.impl.packet.PacketType;
import cc.unknown.mixin.interfaces.packet.IC01PacketChatMessage;
import cc.unknown.module.Module;
import cc.unknown.module.impl.ModuleCategory;
import cc.unknown.module.setting.impl.ModeValue;
import net.minecraft.network.play.client.C01PacketChatMessage;

public class ChatBypass extends Module {

	private ModeValue mode = new ModeValue("Mode", "Universoraft", "Universocraft");

	public ChatBypass() {
		super("ChatBypass", ModuleCategory.Exploit);
		this.registerSetting(mode);
	}

	@EventLink
	public void onPacket(PacketEvent e) {
		switch (mode.getMode()) {
		case "Universo":
		    if (e.getType() == PacketType.Send && e.getPacket() instanceof C01PacketChatMessage) {
		        C01PacketChatMessage p = (C01PacketChatMessage) e.getPacket();
		        String message = p.getMessage();
		        if (!message.startsWith("/")) {
		            String m = Arrays.stream(message.split(" ")).map(word -> "y" + word).collect(Collectors.joining(" "));
		            ((IC01PacketChatMessage) p).setMessage(m);
		            e.setPacket(p);
		        }
		    }
			break;
		}
	}
}
