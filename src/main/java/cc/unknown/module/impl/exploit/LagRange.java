package cc.unknown.module.impl.exploit;

import cc.unknown.Haru;
import cc.unknown.event.impl.api.EventLink;
import cc.unknown.event.impl.other.ShutdownEvent;
import cc.unknown.event.impl.other.StartGameEvent;
import cc.unknown.event.impl.player.TickEvent;
import cc.unknown.module.Module;
import cc.unknown.module.impl.ModuleCategory;
import cc.unknown.module.impl.player.Blink;
import cc.unknown.module.setting.impl.SliderValue;
import cc.unknown.utils.player.PlayerUtil;
import net.minecraft.entity.Entity;

public class LagRange extends Module {

    public final SliderValue range = new SliderValue("Range", 3.0, 2.0, 5.0, 0.1);
    public final SliderValue hurtTicks = new SliderValue("Ticks", 0, 0, 10, 0.5);
	
	public LagRange() {
		super("LagRange", ModuleCategory.Exploit);
		this.registerSetting(range, hurtTicks);
	}

    @EventLink
    public void onTick(TickEvent e) {
        Blink blink = (Blink) Haru.instance.getModuleManager().getModule(Blink.class);
        Entity target = (Entity) PlayerUtil.getClosePlayers(range.getInput());
        if(target == null) {
            blink.setToggled(false);
            return;
        }
        
        /* Remaining time an entity will be "immune" to further damage after being hurt */
        blink.setToggled(target.hurtResistantTime > hurtTicks.getInput());
    }

    @EventLink
    public void onStartGame(StartGameEvent e) {
    	this.disable();
    }

    @EventLink
    public void onShutdown(ShutdownEvent e) {
    	this.disable();
    }
}
