package cc.unknown.module.impl.exploit;

import cc.unknown.Haru;
import cc.unknown.event.impl.EventLink;
import cc.unknown.event.impl.other.ShutdownEvent;
import cc.unknown.event.impl.other.StartGameEvent;
import cc.unknown.event.impl.player.TickEvent;
import cc.unknown.module.Module;
import cc.unknown.module.impl.ModuleCategory;
import cc.unknown.module.impl.player.Blink;
import cc.unknown.module.setting.impl.SliderValue;
import cc.unknown.utils.player.PlayerUtil;
import net.minecraft.entity.Entity;

public class LagRange extends Module {
	
    private final SliderValue range = new SliderValue("Range", 3, 3, 15, 0.5);
    private final SliderValue hurtTicks = new SliderValue("Hurt resistant time", 1, 0, 10, 1);
	
	public LagRange() {
		super("LagRange", ModuleCategory.Exploit);
		this.registerSetting(range, hurtTicks);
	}

    @Override
    public void onEnable() {
    	Haru.instance.getModuleManager().getModule(Blink.class).setToggled(false);
    }

    @EventLink
    public void onTick(TickEvent e) {
        Blink blink = (Blink) Haru.instance.getModuleManager().getModule(Blink.class);
        Entity target = PlayerUtil.getClosetPlayers(range.getInput());
        if(target == null) {
            blink.setToggled(false);
            return;
        }
        blink.setToggled(target.hurtResistantTime > hurtTicks.getInput());
        blink.setHidden(true);
    }

	@EventLink
	public void onStartGame(StartGameEvent e) {
		this.disable();
	}

	@EventLink
	public void onShutdown(ShutdownEvent e) {
		this.disable();
	}
}
